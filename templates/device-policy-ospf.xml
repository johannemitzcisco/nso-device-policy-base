<config xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
  <device>
    <name>{$DEVICE-NAME}</name>
      <config>
      <router xmlns="http://tail-f.com/ned/cisco-ios-xr">
      <ospf>
        <name>VISA-OSPF</name>
        <nsr/>
        <router-id>{/network-service[name=$SERVICE-NAME]/topology/endpoint[topology-name=$DEVICE-TOPOLOGY-NAME]/policies/loopback[interface-number=0]/ip-address}</router-id>
        <fast-reroute>
          <per-link>
          </per-link>
        </fast-reroute>
        <timers>
          <throttle>
            <lsa>
              <all>
                <delay>0</delay>
                <min-delay>100</min-delay>
                <max-delay>1000</max-delay>
              </all>
            </lsa>
            <spf>
              <delay>10</delay>
              <min-delay>100</min-delay>
              <max-delay>1000</max-delay>
            </spf>
          </throttle>
          <lsa>
            <min-arrival>0</min-arrival>
          </lsa>
          <pacing>
            <flood>5</flood>
          </pacing>
        </timers>
        <auto-cost>
          <reference-bandwidth>100000</reference-bandwidth>
        </auto-cost>
        <bfd>
          <fast-detect/>
          <minimum-interval>50</minimum-interval>
          <multiplier>3</multiplier>
        </bfd>
          <area>
            <id>0</id>
            <bfd>
              <minimum-interval>50</minimum-interval>
              <fast-detect>
              </fast-detect>
              <multiplier>3</multiplier>
            </bfd>
            <mpls>
              <traffic-eng/>
            </mpls>
           <interface foreach="{/network-service[name=$SERVICE-NAME]/topology/connection[type/core-core]/side[device=$DEVICE-TOPOLOGY-NAME]/port">
              <name>{interface-type}{interface-name}</name>
              <bfd>
                <fast-detect>
                </fast-detect>
              </bfd>
              <cost>{current()/../../cost}</cost>
              <fast-reroute>
                <per-prefix/>
              </fast-reroute>
              <hello-interval>1</hello-interval>
              <network>point-to-point</network>
            </interface>
            <interface>
              <name>Loopback0</name>
              <prefix-sid>
                <absolute>{/network-service[name=$SERVICE-NAME]/topology/endpoint[topology-name=$DEVICE-TOPOLOGY-NAME]/policies/loopback[interface-number=0]/prefix-sid}</absolute>
              </prefix-sid>
            </interface>
          </area>
          <nsf>
            <ietf>
            </ietf>
          </nsf>
          <segment-routing>
            <mpls/>
            <forwarding>mpls</forwarding>
          </segment-routing>
        </ospf>
      </router>
      </config>
  </device>
  </devices>
</config>
